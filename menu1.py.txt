#!/usr/bin/python

import os,sys,importlib
from os import path


def RunScript(sPath,sFile,bDirect=2):
    
    try:
        if bDirect == 0:
            sRunPath = sPath
            with open(path.join(sPath,sFile)) as f:
                exec(compile(f.read(), "temp.p", 'exec'), globals())
        elif bDirect == 1:
            tmp = os.getcwd()
            os.chdir(sPath)
            os.system("python " + sFile)
            os.chdir(tmp)
        elif bDirect == 2:
            sys.path.insert(0,sPath)
            tmp = importlib.import_module(sFile.split(".py")[0])
            tmp.run()
            sys.path.remove(sPath)
        else:
            pass
    except BaseException as p:
        print("\nProblem in Running",sFile,"at",sPath,"Script :",p)

#####

def Runner(sRootPath):
    ''' Runs all the scripts in lower directories
    @param sRootPath Specifies the Path from which Script Running should start
    @return None
    '''
    try:
        for root, dirs, files in os.walk(sRootPath):
            #bypass dir with _ and __ , Process only if some files  
            if (root.endswith('_') == False) and (len(files) > 0 ) and \
            (root != sRootPath) and (root.find("__")==-1):
                print("-" * 20)
                print(" Root: ",root)
                print("-" * 20)
                for name in files:
                    #check for scripts but avoid packages
                    if name.endswith(".py") and (root.find("__")==-1):
                        print(" Running Script : ",name)
                        RunScript(root,name)
                        print()
    except Exception as p:
        print("\nProblem in Runner :",p)                            

#####

###########################################################################
### Main Program
###########################################################################
        
#####
## Run through the Path
if __name__ == "__main__":
    print(slIntro)
    Runner(path.dirname(__file__))
